#db불러오기
library(DBI)
library(RPostgreSQL)

con<-dbConnect(dbDriver("PostgreSQL"),dbname = "",host = "",
               user = "", password = "")
recordSet<-dbSendQuery(con, "select * from bbp_prd_tabown.tbbp10_cc_01_201902")
data<-dbFetch(recordSet)

data
summary(data)

# library 
install.packages("dplyr")
install.packages()
#데이터 전처리
attach(data)

# character -> integer
colnames(data)
data$nw_zp<-as.integer(nw_zp)
data$mkt_shot_card_loan_avg_use_amt<-as.integer(mkt_shot_card_loan_avg_use_amt)
data$mkt_csh_svc_avg_use_amt<-as.integer(mkt_csh_svc_avg_use_amt)
data$bc_shot_card_loan_avg_use_amt<-as.integer(bc_shot_card_loan_avg_use_amt)
data$bc_csh_svc_avg_use_amt<-as.integer(bc_csh_svc_avg_use_amt)
summary(data)

#최빈값
getmode <- function(v){
  uniqv <- unique(v)
  uniqv[which.max(tabulate(match(v,uniqv)))]
}

result<-getmode(data$mkt_csh_svc_avg_use_amt)
print(result)

#사본생성


# NA
is.na(mkt_shot_card_loan_avg_use_amt)
# 201902 연령대별 시장 단기카드대출평균이용금액
barplot()
